<script>
  fetch('https://docs.google.com/spreadsheets/d/1MmKfvt4h7HxEEgsZtZ7Iv8oIQONVZu_vNUBPX4TAbdw/gviz/tq?tqx=out:json')
    .then(res => res.text())
    .then(rep => {
      const jsonData = JSON.parse(rep.substr(47).slice(0, -2));
      const rows = jsonData.table.rows;

      let html = '';
      rows.forEach(row => {
        try {
          const title = row.c[0]?.v || '';
          const description = row.c[1]?.v || '';
          const linkRaw = row.c[2]?.v || '#';
          const link = linkRaw.trim(); // Trim किया

          // Check if the link is valid
          const isValidURL = link.startsWith("http");

          html += `
            <div class="yojna">
              <h3>${title}</h3>
              <p>${description}</p>
              ${isValidURL ? `<a href="${link}" target="_blank">पढ़ें पूरी योजना</a>` : ''}
            </div>
          `;
        } catch (e) {
          console.error("Error in row", e);
        }
      });

      document.getElementById('yojna-container').innerHTML = html || '<p>कोई योजना उपलब्ध नहीं है।</p>';
    })
    .catch(err => {
      console.error("Fetching Google Sheet failed:", err);
      document.getElementById('yojna-container').innerHTML = '<p>डेटा लोड नहीं हो पाया। कृपया बाद में प्रयास करें।</p>';
    });
</script>
